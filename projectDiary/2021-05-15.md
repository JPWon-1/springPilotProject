Spring Security를 이용한 회원가입 , 로그인 구현하는 중.

기존에 여러 강의를 듣고 로그인을 구현해보았지만, 제대로 구현이 되지 않았고, 여러 강의를 들어보았지만 모든 강의들이 일치하는 부분도 있지만, 그 외의 디테일한 부분들이 모두 다르기에 다른 사람들이 하는 코드를 따라치는 것으로는 이 부분을 쉽게 넘어 갈 수 없다고 생각하여 회원가입부터 다시 시작하려고 코드를 롤백하였다.

우선, join page를 만들어 email, password 만 넘겨서 가볍게 회원가입을 진행하는 코드를 만들었다. 
password는 넘긴 후에 BCryptPasswordEncoder를 이용하여 암호를 저장시켰다.
이를 위해 webSecurityConfig 파일 안에 
```java
@Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
```
를 선언하였고 , 
```java
String encodedPassword = bCryptPasswordEncoder.encode(member.getPassword());
```
위와 같은 형식으로 패스워드를 encoding 해주었다.

이를 통해 비밀번호가 $2a$10$Pd3oI0b5/iKK.qN.oXMc8ubtUcdzr4lpe38O0U2NfgFTvaoZPRvya

와 같은 형태로 입력되는 것을 확인할 수 있었다.

이 과정에서 두가지 장애물이 발생하여 하루종일 시간을 할애할수밖에 없었다.
첫번째로는 WebSecurityConfig 파일에서 authorizeRequest에서 authorize안 된 페이지를 모두 /login으로 보내게 해놓았더니, 회원가입이 실패를 한 상태여도 자꾸 login으로 보내지는 것이었다. 
이 과정에서 postman으로 확인을 해도 안되었고, debugging도 안되었기에 매우 답답한 부분이였지만 
결국 찾아내서 픽스하였고 , 이 부분은 후에 프로젝트를 진행하면서 제대로 수정해야 할 것 같다. 지금은 임시방편으로 해결해두었을 뿐이다.
두번째로는 회원가입을 하는데 ajax 200OK 를 반환했는데도 불구하고 에러가 반환되는 것이였다.
이유는 dataType:json을 하여서 성공시 반환받는 데이터값도 json이여야 하는데, 나는 컨트롤러에서 성공시 return으로 다른 mapping url을 입력해두어서 올바른 data값을 리턴받지 못하여 생기는 에러였다

ajax option 에서 dataType 을 지워 해결했는데, 후에는 다른 방법으로도 해결할 수 있을 것 같다.

--> TODO: 로그인을 구현해야 할 것 같다. 로그인 할 때 패스워드를 detokenizer 하여 비교하여 로그인 하고
로그인에 성공하면 jwt토큰을 반환하여 로그인하는 동안 헤더에 계속 가지고 다니며 회원임을 인증한 상태로 페이지를 돌아다닐 수 있는 기능을 구현할 것이다.


