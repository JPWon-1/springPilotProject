1. oauth를 위한 properties 파일을 생성함.
스프링부트에서는 properties의 이름을 application-xxx.properties로 만들면
xxx라는 이름의 profile이 생성된다.
즉, profile=xxx 라는 식으로 호출하면 해당 properties의 설정들을 가져올 수 있다.
따라서 oauth 전용 properties를 만들고 메인으로 쓸 application.properties에서
```sql
spring.profiles.include=oauth 
```
를 추가하였다

1) 구글로 로그인하기
- 구글 콘솔에 가서 새 프로젝트를 생성하고 
oauth동의를 해주고, 사용자 인증 정보를 만든다.
앱 이름과, 앱 유형(웹애플리케이션) 그리고 승인된 리디렉션 URI를 설정해주면 된다.
* 승인된 리디렉션 URI는 서비스에서 파라미터로 인증 정보를 주었을 때 인증이 성공하면 구글에서 리다이렉트할 URL이다.
* 스프링부트2 버젼에서는 기본적으로 도메인/login/oauth2/code/google or somethingelse..
식으로 리다이렉트 URL을 지원해준다.
* 따라서 컨트롤러를 만들 필요가 없다
* 현재는 개발 단계이기에 http://localhost:8080/login/oauth2/code/google 로만 등록한다

이 과정에서 사용자 인증키와 패스워드를 발급받는데 이를 application-oauth.properties에 추가해준다.

spring.security.oauth2.client.registration.google.client-id=아이디
spring.security.oauth2.client.registration.google.client-secret=패스워드
spring.security.oauth2.client.registration.google.scope=email,profile

scope는 이후에 다른 소셜 로그인을 구현해줄 때 겹치지 않게 하기 위해 email과 profile을 등록해준다.( 구글의 기본값은 openid, profile , email 인데 그렇지 않은 서비스 ex)네이버,카카오 등.. 과 겹치지 않게 하기 위해서이다. ) 

그리고 위의 아이디와 패스워드는 절대 노출되면 안되기에(비트코인 채굴등에 쓰일 수가 있음)
.gitignore에 꼭 꼭 등록해주자.

oauth 과정 정리.
1. 코드 받기(인증)
2. 엑세스토큰(권한)
3. 사용자 프로필 정보를 가져옴
4. 정보를 토대로 회원가입을 자동으로 진행시키기도 함.
4-2. 구글에서 제공해주는 정보 외에 추가 정보가 필요 할 경우
추가적인 회원창이 나와서 회원가입을 해야함

oauth로 로그인한 회원도 회원가입을 진행시켜주기 위해 다음과 같은 것을 진행하였다.

스프링 시큐리티는 자기만의 시큐리티 세션을 가지고 있고
시큐리티 세션 안에 들어갈 수 있는 타입은 Authentication 객체만 들어갈 수 있다.
Authentication 안에 들어 갈 수 있는 타입은
1. UserDetails <- 일반적인 로그인
2. Oauth2User  <- oAuth 로그인 
이다.
Oauth2 객체도 PrincipalDetails 로 잡아서 Authentication 객체 안에 넣어버리면
oauth로 로그인하던 일반적인 로그인을 하던 PrincipalDetails 타입으로 받을 수 있다!

public class PrincipalDetails implements UserDetails, OAuth2User <- UserDetails,Oauth2User를 impl하여
다형성을 이용하여 두 객체를 묶는다!

PrincipalOauth2UserService 에서 DefaultOAuth2UserService 를 상속받아
loadUser를 구현한다. oAuth2로 로그인하면 자동으로 이 메서드로 가게된다.
이곳에서 oauth 회원가입을 진행한다.

TODO. 네이버 로그인